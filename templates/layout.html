<!doctype html>

{% load staticfiles %}

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}FormalDateFinder.com{% endblock %}</title>
    <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/css/normalize.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <script src="/static/js/jquery-2.1.1.min.js"></script>
    <script src="/static/js/utils.js"></script>

    <link href="{% static 'bootstrap/css/bootstrap.min.css' %}"
    rel="stylesheet" media="screen">




    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
    <script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>

    <div id="fb-root"></div>
    <script>

        var mapToDom;

        mapToDom = function(response) {
          var k, v, _results;
          _results = [];
          for (k in response) {
            v = response[k];
            if ($("#" + k).length !== 0) {
              _results.push($("#" + k).text(v));
            } else {
              _results.push(void 0);
            }
          }
          return _results;
        };


        window.fbAsyncInit = function() {
            FB.init({
                //appId: '{{ fb_app_id }}',
                appId: '606066119471642',
                status: true,
                xfbml: true,
                version:'v2.0'
            });

            /*SomeRequest("facebook.fuckyou", function(response){
                var photoUrl = response.photoUrl;
                $(".circle-image").css({"background-image": photoUrl});
                var photoCaption = response.photoCaption;
                $(".photo-caption").text(photoCaption);
            });*/

            FB.Event.subscribe('auth.authResponseChange', function(response) {
                if (response.status === 'connected') {
                    FB.api('/me', function(response) {
                        console.log('Logged in as ' + response.name + '.');
                        var element = document.getElementById("logged-in");
                        element.innerHTML = "Welcome, " + response.name + "!";
                        element.style.color = "blue";
                        console.log(response);
                        mapToDom(response);
                    });
                    /* make the API call */
                    FB.api(
                        "/me/picture",
                        function (response) {
                          if (response && !response.error) {
                            /* handle the result */
                            console.log(response);
                            $(".circle-image").css({"background-image": photoUrl});
                          }
                        }
                    );
                }
                else if (response.status === 'not_authorized') {
                    FB.login();
                }
                else {
                    FB.login();
                }
            });

            FB.getLoginStatus(function(response){
                if (response.status == 'connected') {
                    console.log(response);
                }
            });

        };

        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.com/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

    <div class="menu-container">
        <div class="menu">
            <a class="heading" href="/">FormalDateFinder.com</a>
            <ul>
                <li><a href="/upcoming/">View Upcoming Events</a></li>
                <li><a href="/register/">Register an Event</a></li>
                <li><a href="/profile/">Profile</a></li>
                <li id='logged-in'><a href="javascript: FB.login()">Login</a></li>
            </ul>
        </div>
    </div>
    {% block content %}
    {% endblock %}
</body>
</html>
